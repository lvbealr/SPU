<p align="center">
  <a href="" rel="noopener">
 <img width=400 height=150 src="https://i.imgur.com/EtoWvrT.png" alt="Project logo"></a>
</p>

<h1 align="center">‚öôÔ∏è SOFT PROCESSING UNIT üî®</h1>

## üìù Table of Contents

- [About](#about)
- [How It Works](#how_it_works)
- [Installation](#installation)
- [Assembler Syntax](#assembler_syntax)
- [Assembler](#assembler)
- [Processor](#processor)
- [Disassembler](#disassembler)
- [Example Using](#example_using)
- [Built Using](#built_using)
- [Authors](#authors)

---

## üßê About <a name = "about"></a>

SPU (Soft Processing Unit) is a software processor emulator designed to simulate the operation of a real processor. This project is a complete system that allows you to create and execute programs at a low level. SPU consists of three key modules, each of which plays an important role in the code processing chain:

* `Assembler`
* `Processor`
* `Disassembler` (under development)

---

## üîÑ How It Works <a name = "how_it_works"></a>

It all starts with writing a program in simplified assembly language to represent the instructions of the processor. These commands are more readable than machine code, which consists of numbers. Example:

```asm
PUSH AX
PUSH 1

JNE NEXT:
  PUSH 1
  POP BX
  RET
```

Once the program is written, it is converted to ‚Äúmachine code‚Äù using the Assembler module. It parses each instruction, checks its correctness and translates it into a certain number (instruction number) - almost machine code - understandable to the processor.

The Processor module emulates the execution of machine code. The machine code is read by the processor, a pointer to the first instruction is set, the processor reads the instructions, decodes them, performs operations, updates registers and memory, and moves to the next instruction.

The Dissembler module allows you to convert machine code back into readable assembler for analysis and debugging.

## üóù Installation <a name = "installation"></a>

Clone repositories and update all submodules:

```bash
git clone git@github.com:lvbealr/SPU.git
git submodule update --init --remote --recursive
```

---

## üìú Assembler Syntax <a name = "assembler_syntax"></a>

1. Commands & Arguments:
  - Each non-blank line (excluding lines with only comments) must contain **exactly one instruction**
  - If an instruction has **two arguments**, separate them with a +. The **register** must come first.
  - Example: POP [AX + 4]
2. Comments:
  - Use ; to start a comment. Comment can be placed:
    - On their own line (e. g., `; this is a dummy-comment`)
    - After an instruction (e. g., ``ADD ; a + b``)
3. Program Termination
  - Every program **must** end with the **hlt** command to ensure correct execution.

Example of program:

```asm
IN
POP AX

CALL fact

PUSH BX
OUT

HLT

fact:
    PUSH AX
    PUSH 1
    JNE NEXT:
        PUSH 1
        POP BX
        RET
    NEXT:

    PUSH AX

    PUSH AX
    PUSH 1
    SUB
    POP AX

    CALL fact

    PUSH BX
    MUL
    POP BX
    RET
```
> [!NOTE]
> Labels (e. g., `loop:`) mark jump targets and do not count as separate instruction
> Whitespace between commands, arguments, and ; is optional.

---

## üèó Assembler <a name = "assembler"></a>

The assembler module converts simplified x86-64 assembly text code into a binary format understandable by the processor. It supports basic instructions (e.g., PUSH, MUL, IN, JMP, CALL, SQRT) and register and memory handling.

### Compilation

Go to the project directory and execute:

```bash
make assembler
```

Then execute command:

```bash
./build/assembler <path-to-file.asm>
```

* `path-to-file.asm` - path to the source file in assembly language

---

## üèó Processor <a name = "processor"></a>

The processor is the central module of the SPU, which can be called the ‚Äúheart‚Äù of the project. It is responsible for executing the machine code generated by the Assembler and simulates the operation of a real processor. This module fully reproduces key aspects of the processor, including memory management, register management and instruction execution.

### Compilation

Go to the project directory and execute:

```bash
make processor
```

Then execute command:

```bash
./build/processor <binary_file.bin>
```

* `binary_file.bin` - assembled binary file

---

## üèó Disassembler <a name = "disassembler"></a>

`In progress...`

A disassembler performs the inverse task of an assembler: it translates machine code back into human-readable assembly language code. This module is especially useful for analyzing and debugging programs.

---

## ‚öô Example Using <a name = "example_using"></a>

<p align="center">
  <a href="" rel="noopener">
 <img src="https://i.imgur.com/tnM3aAQ.png" alt="circle"></a>
</p>

## ‚õè Built Using <a name = "built_using"></a>

- [customWarning](https://github.com/lvbealr/customWarning) - Warning Module
- [colorPrint](https://github.com/lvbealr/colorPrint) - Module For Colourful Print

---

## ‚úç Authors <a name = "authors"></a>

- [@lvbealr](https://github.com/lvbealr) - Idea & Initial work
